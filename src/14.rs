use std::collections::HashMap;
use std::ops::Range;

fn main() {
    println!("Part 1 is {}", compute(input(), false));
    println!("Part 2 is {}", compute(input(), true));
}

#[derive(Debug, PartialEq, Eq)]
enum Value {
    Sand,
    Rock,
}

fn compute(input: &'static str, part2: bool) -> usize {
    let mut cave = HashMap::new();

    for line in input.trim().lines().map(|line| line.trim()) {
        for window in line
            .split(" -> ")
            .map(|coordinates| coordinates.split_once(',').unwrap())
            .map(|(x, y)| (x.parse().unwrap(), y.parse().unwrap()))
            .collect::<Vec<(u32, u32)>>()
            .windows(2)
        {
            let (start_x, start_y) = window[0];
            let (end_x, end_y) = window[1];

            for x in create_range(start_x, end_x) {
                for y in create_range(start_y, end_y) {
                    cave.insert((x, y), Value::Rock);
                }
            }
        }
    }

    // let min_x = *cave.iter().map(|((x, _), _)| x).min().unwrap();
    let max_x = *cave.iter().map(|((x, _), _)| x).max().unwrap();
    let lowest = *cave.iter().map(|((_, y), _)| y).max().unwrap();

    if part2 {
        for x in 0..(max_x * 2) {
            cave.insert((x, lowest + 2), Value::Rock);
        }
    }

    #[cfg(test)]
    print_cave(&cave, 0..(max_x * 2), 0..lowest + 3, None);

    'main: loop {
        let (mut x, mut y) = (500, 0);

        loop {
            #[cfg(test)]
            print_cave(&cave, 0..(max_x * 2), 0..lowest + 3, Some((x, y)));

            if y > lowest + 5 || cave.contains_key(&(x, y)) {
                break 'main;
            }

            if !cave.contains_key(&(x, y + 1)) {
                y += 1;
                continue;
            }

            if !cave.contains_key(&(x - 1, y + 1)) {
                y += 1;
                x -= 1;
                continue;
            }

            if !cave.contains_key(&(x + 1, y + 1)) {
                y += 1;
                x += 1;
                continue;
            }

            cave.insert((x, y), Value::Sand);
            break;
        }
    }

    print_cave(&cave, 0..(max_x * 2), 0..lowest + 3, None);

    cave.iter()
        .filter(|(_, value)| **value == Value::Sand)
        .count()
}

fn print_cave(
    cave: &HashMap<(u32, u32), Value>,
    x_range: Range<u32>,
    y_range: Range<u32>,
    current: Option<(u32, u32)>,
) {
    println!();
    println!();

    for y in y_range {
        for x in x_range.clone() {
            if let Some((current_x, current_y)) = current {
                if current_x == x && current_y == y {
                    print!("+");
                    continue;
                }
            }

            if let Some(value) = cave.get(&(x, y)) {
                let char = match value {
                    Value::Sand => 'o',
                    Value::Rock => '#',
                };

                print!("{char}")
            } else {
                print!(".");
            }
        }

        println!();
    }
    println!();
    println!();
}

fn create_range(a: u32, b: u32) -> Box<dyn std::iter::Iterator<Item = u32>> {
    if a < b {
        Box::new(a..=b)
    } else {
        Box::new((b..=a).rev())
    }
}

#[test]
fn test() {
    assert_eq!(
        24,
        compute(
            "
        498,4 -> 498,6 -> 496,6
        503,4 -> 502,4 -> 502,9 -> 494,9
    ",
            false
        )
    );
    assert_eq!(
        93,
        compute(
            "
        498,4 -> 498,6 -> 496,6
        503,4 -> 502,4 -> 502,9 -> 494,9
    ",
            true
        )
    );
}

fn input() -> &'static str {
    "
    494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
493,114 -> 498,114
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
482,68 -> 482,72 -> 479,72 -> 479,76 -> 495,76 -> 495,72 -> 487,72 -> 487,68
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
513,145 -> 517,145
487,120 -> 487,124 -> 486,124 -> 486,129 -> 493,129 -> 493,124 -> 490,124 -> 490,120
486,114 -> 491,114
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
479,85 -> 479,89 -> 473,89 -> 473,95 -> 488,95 -> 488,89 -> 484,89 -> 484,85
471,169 -> 475,169
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
492,108 -> 497,108
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
477,165 -> 481,165
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
468,167 -> 472,167
468,82 -> 480,82
484,27 -> 501,27 -> 501,26
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
474,163 -> 478,163
501,145 -> 505,145
495,134 -> 500,134
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
500,114 -> 505,114
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
478,51 -> 478,52 -> 491,52 -> 491,51
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
504,117 -> 509,117
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
479,85 -> 479,89 -> 473,89 -> 473,95 -> 488,95 -> 488,89 -> 484,89 -> 484,85
510,143 -> 514,143
482,68 -> 482,72 -> 479,72 -> 479,76 -> 495,76 -> 495,72 -> 487,72 -> 487,68
459,169 -> 463,169
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
490,117 -> 495,117
479,85 -> 479,89 -> 473,89 -> 473,95 -> 488,95 -> 488,89 -> 484,89 -> 484,85
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
496,138 -> 501,138
474,167 -> 478,167
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
479,32 -> 479,33 -> 491,33 -> 491,32
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
486,98 -> 486,101 -> 483,101 -> 483,105 -> 494,105 -> 494,101 -> 492,101 -> 492,98
487,120 -> 487,124 -> 486,124 -> 486,129 -> 493,129 -> 493,124 -> 490,124 -> 490,120
483,117 -> 488,117
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
465,165 -> 469,165
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
504,143 -> 508,143
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
491,132 -> 496,132
485,136 -> 490,136
462,167 -> 466,167
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
487,120 -> 487,124 -> 486,124 -> 486,129 -> 493,129 -> 493,124 -> 490,124 -> 490,120
486,98 -> 486,101 -> 483,101 -> 483,105 -> 494,105 -> 494,101 -> 492,101 -> 492,98
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
486,98 -> 486,101 -> 483,101 -> 483,105 -> 494,105 -> 494,101 -> 492,101 -> 492,98
503,138 -> 508,138
468,163 -> 472,163
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
479,85 -> 479,89 -> 473,89 -> 473,95 -> 488,95 -> 488,89 -> 484,89 -> 484,85
489,111 -> 494,111
482,68 -> 482,72 -> 479,72 -> 479,76 -> 495,76 -> 495,72 -> 487,72 -> 487,68
482,68 -> 482,72 -> 479,72 -> 479,76 -> 495,76 -> 495,72 -> 487,72 -> 487,68
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
480,167 -> 484,167
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
471,161 -> 475,161
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
484,27 -> 501,27 -> 501,26
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
479,85 -> 479,89 -> 473,89 -> 473,95 -> 488,95 -> 488,89 -> 484,89 -> 484,85
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
487,120 -> 487,124 -> 486,124 -> 486,129 -> 493,129 -> 493,124 -> 490,124 -> 490,120
492,136 -> 497,136
499,136 -> 504,136
497,117 -> 502,117
477,169 -> 481,169
479,85 -> 479,89 -> 473,89 -> 473,95 -> 488,95 -> 488,89 -> 484,89 -> 484,85
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
488,134 -> 493,134
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
478,51 -> 478,52 -> 491,52 -> 491,51
482,138 -> 487,138
482,68 -> 482,72 -> 479,72 -> 479,76 -> 495,76 -> 495,72 -> 487,72 -> 487,68
486,98 -> 486,101 -> 483,101 -> 483,105 -> 494,105 -> 494,101 -> 492,101 -> 492,98
489,138 -> 494,138
482,68 -> 482,72 -> 479,72 -> 479,76 -> 495,76 -> 495,72 -> 487,72 -> 487,68
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
507,141 -> 511,141
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
465,169 -> 469,169
479,32 -> 479,33 -> 491,33 -> 491,32
486,98 -> 486,101 -> 483,101 -> 483,105 -> 494,105 -> 494,101 -> 492,101 -> 492,98
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
507,145 -> 511,145
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
471,165 -> 475,165
474,46 -> 474,36 -> 474,46 -> 476,46 -> 476,37 -> 476,46 -> 478,46 -> 478,44 -> 478,46 -> 480,46 -> 480,42 -> 480,46
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
494,23 -> 494,16 -> 494,23 -> 496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,20 -> 498,23 -> 500,23 -> 500,20 -> 500,23 -> 502,23 -> 502,22 -> 502,23 -> 504,23 -> 504,14 -> 504,23
479,32 -> 479,33 -> 491,33 -> 491,32
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
487,120 -> 487,124 -> 486,124 -> 486,129 -> 493,129 -> 493,124 -> 490,124 -> 490,120
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
487,120 -> 487,124 -> 486,124 -> 486,129 -> 493,129 -> 493,124 -> 490,124 -> 490,120
486,98 -> 486,101 -> 483,101 -> 483,105 -> 494,105 -> 494,101 -> 492,101 -> 492,98
479,85 -> 479,89 -> 473,89 -> 473,95 -> 488,95 -> 488,89 -> 484,89 -> 484,85
483,169 -> 487,169
478,51 -> 478,52 -> 491,52 -> 491,51
482,68 -> 482,72 -> 479,72 -> 479,76 -> 495,76 -> 495,72 -> 487,72 -> 487,68
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
474,158 -> 474,156 -> 474,158 -> 476,158 -> 476,157 -> 476,158 -> 478,158 -> 478,155 -> 478,158 -> 480,158 -> 480,154 -> 480,158 -> 482,158 -> 482,157 -> 482,158 -> 484,158 -> 484,154 -> 484,158 -> 486,158 -> 486,149 -> 486,158
487,120 -> 487,124 -> 486,124 -> 486,129 -> 493,129 -> 493,124 -> 490,124 -> 490,120
486,98 -> 486,101 -> 483,101 -> 483,105 -> 494,105 -> 494,101 -> 492,101 -> 492,98
469,65 -> 469,55 -> 469,65 -> 471,65 -> 471,60 -> 471,65 -> 473,65 -> 473,58 -> 473,65 -> 475,65 -> 475,59 -> 475,65 -> 477,65 -> 477,56 -> 477,65 -> 479,65 -> 479,59 -> 479,65 -> 481,65 -> 481,59 -> 481,65 -> 483,65 -> 483,64 -> 483,65
496,111 -> 501,111

    "
}
